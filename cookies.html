<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>í¬ì¶˜ì¿ í‚¤ ì´ë²¤íŠ¸</title>
  <link rel="stylesheet" href="./style.css">
</head>
  <body>
    <div class="container cookies">
      <h1>ì˜¤ëŠ˜ì˜ í¬ì¶˜ì¿ í‚¤</h1>
      <p id="message"></p>
      <div class="cookie" id="cookie"></div>
      <div class="message" id="messageBox"></div>
      <button id="reviewBtn" onclick="submitCookies()">ì‘ëª¨í•˜ê¸°</button>
      <button id="backBtn" onclick="location.href = 'main.html'">ë’¤ë¡œê°€ê¸°</button>
    </div>
        
    <script>
      const cookie = document.getElementById("cookie");
      const messageBox = document.getElementById("messageBox");
      const button = document.getElementById("reviewBtn");

      const fortunes = [
        "ë‹¹ì‹ ì€ ìƒê°ë³´ë‹¤ ê°•í•˜ë‹¤",
        "ê¸°íšŒëŠ” ì¤€ë¹„ëœ ìì˜ ê²ƒ",
        "ì„±ê³µì€ ìš©ê¸°ì˜ ë˜ ë‹¤ë¥¸ ì´ë¦„",
        "ë©ˆì¶¤ì€ ë„ì•½ì„ ìœ„í•œ ìˆ¨ê³ ë¥´ê¸°",
        "ì˜¤ëŠ˜ì˜ í•œ ê±¸ìŒì´ ë‚´ì¼ì„ ë°”ê¾¼ë‹¤",
        "ë¹›ì€ ìŠ¤ìŠ¤ë¡œë¥¼ íƒœì›Œì•¼ ë‚˜ì˜¨ë‹¤",
        "ê°€ì¥ ì–´ë‘ìš´ ë°¤ì—ë„ ë³„ì€ ëœ¬ë‹¤",
        "ë„˜ì–´ì§„ ê³³ì—ì„œ ì¼ì–´ë‚˜ëŠ” ë²•ì„ ë°°ìš´ë‹¤",
        "ë¶ˆê°€ëŠ¥ì€ ì•„ì§ ì‹œë„ë˜ì§€ ì•Šì€ ê²ƒ",
        "í”ë“¤ë ¤ì•¼ ê½ƒì´ í•€ë‹¤",
        "ë‹¹ì‹ ì˜ ê°€ëŠ¥ì„±ì€ ë¬´í•œí•˜ë‹¤",
        "ì§„ì§œ ìš©ê¸°ëŠ” ì¡°ìš©íˆ ë‚˜ì•„ê°€ëŠ” ê²ƒ",
        "ë‚˜ì•„ê°€ì•¼ ê¸¸ì´ ëœë‹¤",
        "ì²œì²œíˆ ê°€ë„ ê´œì°®ì•„, ë©ˆì¶”ì§€ë§Œ ë§ˆ",
        "ì§€ê¸ˆ ì´ ìˆœê°„ë„ ëˆ„êµ°ê°€ì˜ ê¿ˆì´ë‹¤",
        "ì‘ì€ ì¹œì ˆì´ í° ê¸°ì ì´ ëœë‹¤",
        "í•œ ì¤„ê¸° ë°”ëŒë„ ë›ì„ ë°€ ìˆ˜ ìˆë‹¤",
        "ì–´ì œë³´ë‹¤ ë‚˜ì€ ì˜¤ëŠ˜ì„ ë§Œë“¤ì",
        "ë‹¹ì‹ ì€ ì´ë¯¸ ì¶©ë¶„íˆ ë¹›ë‚˜ê³  ìˆë‹¤"
      ];
      
      window.onload = () => {
        const hasSubmitted = localStorage.getItem('hasSubmitted') === 'true';
        const savedFortune = localStorage.getItem('fortuneMessage');

        if (hasSubmitted) {
          button.disabled = true;
          button.textContent = "ì´ë¯¸ ì‘ëª¨í•˜ì…¨ìŠµë‹ˆë‹¤";
          document.querySelector('#backBtn').style.display = 'block';

          if (savedFortune) {
            messageBox.textContent = savedFortune;
            messageBox.classList.add("show");
          }
        }
      };

      function submitCookies () {
        if (localStorage.getItem('hasSubmitted') === 'true') return;

        cookie.classList.add("crack");
        messageBox.classList.remove("show");
        
        setTimeout(() => {
          const randomIndex = Math.floor(Math.random() * fortunes.length);
          const selectedFortune = fortunes[randomIndex];
          
          // alert("ğŸ¥ " + selectedFortune + "ğŸ¥ ");
          
          messageBox.textContent = selectedFortune;
          messageBox.classList.add("show");
          
          localStorage.setItem('hasSubmitted', 'true');
          localStorage.setItem('fortuneMessage', selectedFortune);
          button.disabled = true;
          button.textContent = "ì´ë¯¸ ì‘ëª¨í•˜ì…¨ìŠµë‹ˆë‹¤";
          cookie.classList.remove("crack");
          document.querySelector('#backBtn').style.display = 'block';

          const formData = new FormData();
          formData.append("entry.1171344104", localStorage.getItem('team'));
          formData.append("entry.2110575320", localStorage.getItem('name'));
          formData.append("entry.1161943199", selectedFortune);

          fetch("https://docs.google.com/forms/u/0/d/e/1FAIpQLSf6Mg-o8qzNXUWIy6iHCxax3oHxRypbPPkO69udn1ezDulv4Q/formResponse", {
              method: "POST",
              mode: "no-cors",
              body: formData
          });
        }, 600);
      }
    </script>
  </body>
</html>
